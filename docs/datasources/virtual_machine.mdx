---
modeline: |
  vim: set ft=pandoc:
description: |
  This datasource is able to get information about existing virtual machines from vSphere
  and return name of one virtual machine that matches all specified filters. This virtual
  machine can later be used in the vSphere Clone builder to select template.
page_title: vSphere VM - Datasources
sidebar_title: Virtual Machine
---

# VMware vSphere Virtual Machine Datasource

Type: `vsphere-virtual_machine`
Artifact BuilderId: `vsphere.virtual_machine`

This datasource is able to get information about existing virtual machines from vSphere
and return name of one virtual machine that matches all specified filters. This virtual
machine can later be used in the vSphere Clone builder to select template.

## Configuration Reference

### Filters Configuration

**Optional:**

@include 'datasource/virtual_machine/Config-not-required.mdx'

### Tags Filter Configuration

@include 'datasource/virtual_machine/Tag.mdx'

**Required:**

@include 'datasource/virtual_machine/Tag-required.mdx'

### Connection Configuration

**Optional:**

@include 'builder/vsphere/common/ConnectConfig-not-required.mdx'

## Output

@include 'datasource/virtual_machine/DatasourceOutput.mdx'

## Example Usage

This is a very basic example that connects to vSphere cluster and tries to search
the latest virtual machine that matches all filters. The machine name is then printed
to console as output variable.
```hcl
data "vsphere-virtual_machine" "default" {
    vcenter_server = "vcenter.example.org"
    insecure_connection = true
    username = "administrator@example.org"
    password = "St4ongPa$$w0rd"
    datacenter = "AZ1"
    latest = true
    vm_tags {
	  category = "team"
	  name = "operations"
	}
	vm_tags {
	  category = "SLA"
	  name = "gold"
	}

}

locals {
  vm_name = data.vsphere-virtual_machine.default.vm_name
}

source "null" "basic-example" {
    communicator = "none"
}

build {
  sources = [
    "source.null.basic-example"
  ]

  provisioner "shell-local" {
    inline = [
      "echo vm_name: ${local.vm_name}",
    ]
  }
}


```
